import{o as e,c as s,a as n,F as t,r as a,t as l,n as o,b as r,d as i,e as c,w as u,f as d,g as p,h as v,i as m,v as f,j as g,k as h}from"./vue-vendor-t3L72M5-.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const y=(e,s)=>{const n=e.__vccOpts||e;for(const[t,a]of s)n[t]=a;return n},_={class:"header"};const b=y({},[["render",function(t,a){return e(),s("div",_,[...a[0]||(a[0]=[n("h1",null,"单片机原理与应用 · 课程答疑机器人",-1),n("div",{class:"subtitle"},"极简设计 · 纯粹交互 · 专注于单片机知识解答",-1)])])}],["__scopeId","data-v-d0ec4b8a"]]),k={class:"course-tags"},I=["onClick"],P=y({__name:"CourseTags",emits:["tag-click"],setup(o,{emit:r}){const i=r,c=[{label:"什么是单片机",question:"什么是单片机？"},{label:"8051结构",question:"8051单片机的结构"},{label:"应用领域",question:"单片机的应用领域"},{label:"与微处理器的区别",question:"单片机与微处理器的区别"},{label:"编程语言",question:"单片机编程语言"},{label:"中断系统",question:"中断系统的工作原理"},{label:"定时器/计数器",question:"定时器/计数器的应用"},{label:"串行通信",question:"串行通信接口"}];return(o,r)=>(e(),s("div",k,[(e(),s(t,null,a(c,e=>n("div",{key:e.question,class:"tag",onClick:s=>{return n=e.question,void i("tag-click",n);var n}},l(e.label),9,I)),64))]))}},[["__scopeId","data-v-0de3179c"]]),U={class:"message-header"},A=["innerHTML"],q=y({__name:"Message",props:{content:{type:String,required:!0},isUser:{type:Boolean,default:!1}},setup(t){const a=t,i=r(()=>{let e=a.content.replace(/\n/g,"</p><p>");return e=e.replace(/•\s+(.+?)(?=\n|$)/g,"<li>$1</li>"),e.includes("<li>")&&(e=e.replace(/<p><li>/g,"<p><ul><li>"),e=e.replace(/<\/li><\/p>/g,"</li></ul></p>")),`<p>${e}</p>`});return(a,r)=>(e(),s("div",{class:o(["message",t.isUser?"user-message":"bot-message"])},[n("div",U,[n("div",{class:o(t.isUser?"user-icon":"bot-icon")},[n("i",{class:o(t.isUser?"fas fa-user":"fas fa-microchip")},null,2)],2),n("div",null,l(t.isUser?"您":"单片机答疑助手"),1)]),n("div",{class:"message-content",innerHTML:i.value},null,8,A)],2))}},[["__scopeId","data-v-b3d9f8f8"]]),w={class:"typing-indicator"};const C=y({},[["render",function(t,a){return e(),s("div",w,[...a[0]||(a[0]=[n("div",{class:"typing-dot"},null,-1),n("div",{class:"typing-dot"},null,-1),n("div",{class:"typing-dot"},null,-1)])])}],["__scopeId","data-v-70434fd0"]]);const E=y({__name:"ChatContainer",setup(n,{expose:l}){const o=v([]),r=v(!1),m=v(null),f=v(!1);i(()=>{f.value=!0,o.value.push({content:"您好！我是单片机原理与应用课程的答疑助手。\n\n我可以为您解答关于单片机结构、工作原理、编程应用等相关问题。例如：\n\n• 单片机的基本概念和分类\n• 8051单片机的内部结构\n• 汇编语言与C语言编程\n• 中断系统、定时器、串行通信等外围设备\n• 单片机在实际项目中的应用\n\n请直接输入您的问题，或点击上方标签快速提问。",isUser:!1}),g()});const g=()=>{c(()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)})};u(o,()=>{g()},{deep:!0});return l({sendMessage:async e=>{if(!e||!e.trim())return;const s={content:e.trim(),isUser:!0};o.value.push(s),r.value=!0;try{const s=o.value.filter(e=>e.isUser||!e.isUser&&e.content).slice(0,-1).map(e=>({role:e.isUser?"user":"assistant",content:e.content})),n=await async function(e,s=[]){var n;try{const t=[{role:"system",content:"你是一个专业的单片机原理与应用课程答疑助手。你的任务是帮助学生理解单片机相关的知识。\n\n你的回答应该：\n1. 准确、专业，基于单片机原理与应用的知识\n2. 清晰易懂，适合初学者理解\n3. 提供具体的例子和实际应用场景\n4. 如果问题超出单片机范围，礼貌地引导回相关话题\n\n请用中文回答，保持友好和专业的教学风格。"},...s,{role:"user",content:e}],a=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer sk-620caf5675344ba08e6b2da7d2a6eff7"},body:JSON.stringify({model:"deepseek-chat",messages:t,temperature:.7,max_tokens:2e3,stream:!1})});if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error((null==(n=e.error)?void 0:n.message)||`API 请求失败: ${a.status} ${a.statusText}`)}const l=await a.json();if(l.choices&&l.choices.length>0)return l.choices[0].message.content.trim();throw new Error("API 返回数据格式错误")}catch(t){throw console.error("DeepSeek API 错误:",t),t}}(e.trim(),s);o.value.push({content:n,isUser:!1})}catch(n){console.error("获取回复失败:",n);let e="抱歉，我暂时无法回答您的问题。";n.message.includes("API Key")?e="API Key 未配置，请检查 .env 文件中的 VITE_DEEPSEEK_API_KEY 设置。":n.message.includes("401")||n.message.includes("403")?e="API Key 无效或已过期，请检查您的 API Key 配置。":n.message.includes("429")?e="API 请求过于频繁，请稍后再试。":(n.message.includes("网络")||n.message.includes("fetch"))&&(e="网络连接失败，请检查您的网络连接。"),o.value.push({content:`${e}\n\n错误详情: ${n.message}`,isUser:!1})}finally{r.value=!1}}}),(n,l)=>(e(),s("div",{class:"chat-container",ref_key:"containerRef",ref:m},[(e(!0),s(t,null,a(o.value,(s,n)=>(e(),d(q,{key:n,content:s.content,"is-user":s.isUser},null,8,["content","is-user"]))),128)),r.value?(e(),d(C,{key:0})):p("",!0)],512))}},[["__scopeId","data-v-000069a5"]]),T={class:"input-container"},K={class:"input-wrapper"},M=y({__name:"InputArea",emits:["send-message"],setup(t,{emit:a}){const l=a,o=v(""),r=()=>{o.value.trim()&&(l("send-message",o.value.trim()),o.value="")},i=e=>{"Enter"===e.key&&r()};return(t,a)=>(e(),s("div",T,[n("div",K,[m(n("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),onKeypress:i,placeholder:"输入关于单片机的问题，例如：单片机的基本组成有哪些？",autocomplete:"off"},null,544),[[f,o.value]]),n("button",{onClick:r,id:"send-button"},[...a[1]||(a[1]=[n("i",{class:"fas fa-paper-plane"},null,-1)])])])]))}},[["__scopeId","data-v-8ee418a9"]]),S={class:"app-container"};h(y({__name:"App",setup(t){const a=v(null),l=e=>{a.value&&a.value.sendMessage(e)},o=e=>{a.value&&a.value.sendMessage(e)};return(t,r)=>(e(),s("div",S,[r[0]||(r[0]=n("div",{class:"decoration-line"},null,-1)),r[1]||(r[1]=n("div",{class:"decoration-line"},null,-1)),r[2]||(r[2]=n("div",{class:"decoration-line"},null,-1)),g(b),g(P,{onTagClick:l}),g(E,{ref_key:"chatContainerRef",ref:a},null,512),g(M,{onSendMessage:o}),r[3]||(r[3]=n("div",{class:"hint"}," 基于原研哉设计理念：极简、留白、呼吸感 | 专注于单片机知识解答 ",-1))]))}},[["__scopeId","data-v-1ad6d717"]])).mount("#app");
